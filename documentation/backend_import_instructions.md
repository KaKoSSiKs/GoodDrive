# Инструкция по импорту данных из Excel

## Вариант 1: Экспорт Excel в CSV (Рекомендуется)

1. Откройте ваш файл `проваоваоао.xlsx` в Excel
2. Выберите "Сохранить как" → "CSV (разделители - запятые)"
3. Сохраните файл как `parts.csv` в корне проекта

### Название колонок в CSV

Файл должен содержать следующие колонки (можно использовать русские или английские названия):

**Обязательные:**
- `Название` или `title` - название запчасти
- `Бренд` или `brand` - название бренда
- `Склад` или `warehouse` - название склада

**Опциональные:**
- `Метка` или `label` - метка запчасти
- `Оригинальный номер` или `original_number`
- `Номер производителя` или `manufacturer_number`
- `Количество` или `quantity` - общее количество
- `На складе` или `stock` - количество на складе
- `В резерве` или `reserve` - количество в резерве
- `Цена` или `price_opt` - цена
- `Описание` или `description`
- `Страна` или `country` - страна бренда
- `Адрес` или `address` - адрес склада

### Пример структуры CSV

```csv
Название,Бренд,Склад,На складе,Цена,Описание
Фильтр масляный,Toyota,Основной склад,15,350,"Качественный масляный фильтр"
Амортизатор передний,Honda,Основной склад,8,1200,Оригинальный амортизатор
```

## Вариант 2: Прямой импорт из Excel

Если у вас уже установлен openpyxl, можно импортировать напрямую:

### Шаги импорта

1. Установите зависимости:
```bash
cd backend
pip install -r requirements.txt
```

2. Выполните миграции:
```bash
python manage.py migrate
```

3. Импортируйте данные (первые 100 запчастей):
```bash
# Из CSV
python manage.py import_from_csv parts.csv --limit 100

# Или из Excel
python manage.py import_parts проваоваоао.xlsx --limit 100
```

## Проверка импортированных данных

После импорта проверьте данные:

```bash
python manage.py shell
```

```python
from catalog.models import Part, Brand, Warehouse

# Количество запчастей
print(f"Всего запчастей: {Part.objects.count()}")
print(f"Активных: {Part.objects.filter(is_active=True).count()}")

# Количество брендов
print(f"Брендов: {Brand.objects.count()}")

# Количество складов
print(f"Складов: {Warehouse.objects.count()}")
```

## Полный импорт (все 6404 запчасти)

Если хотите импортировать все данные:

```bash
python manage.py import_from_csv parts.csv --limit 6500
```

## Примечания

- Универсальная заглушка для изображений будет автоматически создана для каждой запчасти
- Бренды и склады создаются автоматически при первом упоминании
- Повторный импорт не создаст дубликаты (проверка по названию + бренд)
